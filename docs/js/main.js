!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);let o,i;function s(e){o=e}function a(e){i=`${u}/${e}`}const l=document.getElementById("preloader"),c=document.getElementById("login-page"),r=document.getElementById("login-container"),d=document.getElementById("account-container"),u="https://api.jsonbin.io/b",m="$2b$10$pDq3QtKfrwesrxwQ59aWIOvaglvZRlTC5HODRHABUQ/1xwYjGf.1m",g="https://api.jsonbin.io/b/5f3ea46bb88c04101cf83396";function f(){let e=document.getElementsByClassName("new").length;document.getElementById("new-tasks-num").innerText=0==e?"no tasks":1==e?e+" task":e+" tasks"}function y(e,t){let n=`<label class="task__mark">\n                                    <input type="checkbox" >\n                                    <span class="checkmark"></span>\n                            </label>\n                            <p class="task__text">${e}</p>\n                            <img src="assets/img/close.svg" alt="remove task" class="task-close">`,o=document.getElementById("tasks").insertAdjacentElement("afterbegin",document.createElement("li"));return o.classList.add("task",t),o.innerHTML=n,o.setAttribute("id",function e(){let t=Math.floor(1e4*Math.random());for(let n of document.getElementsByClassName("task")){if(n.getAttribute("id")!==t.toString())return t.toString();e()}}()),o}function p(e,t){e.style.display="grid",t.style.display="none",e==r?(!function(){const e=document.getElementById("tasks");for(;e.firstChild;)e.removeChild(e.firstChild)}(),c.classList.add("login")):c.classList.remove("login")}function h(e){let t,n=e.parentElement.parentElement;return n.classList.contains("new")?(n.classList.remove("new"),n.classList.add("done"),t="done"):n.classList.contains("done")&&(n.classList.remove("done"),n.classList.add("new"),t="new"),f(),t}function k(e){for(let t of document.getElementsByClassName("task"))t.style.display="none",t.classList.contains(e)&&(t.style.display="flex")}document.getElementById("add-task").onclick=function(e){let t=document.getElementById("new-task");if(""===t.value)return T(t,"This field should not be empty."),!1;{let e=y(t.value,"new");if(o){o.tasks.push({id:e.getAttribute("id"),task:t.value,status:"new"}),console.log(o)}document.getElementById("new-task").value="",document.getElementById("new-task").placeholder="What is your task for today? ",f(),""!==T&&T(t," ")}},document.getElementById("all-tasks").onclick=function(e){k("task")},document.getElementById("to-do-tasks").onclick=function(e){k("new")},document.getElementById("done-tasks").onclick=function(e){k("done")},document.getElementById("save-tasks").onclick=function(e){e.target.disabled=!0,x(i,o).then(t=>{e.target.innerText="Your tasks successfully saved",e.target.disabled=!1})},document.getElementById("close-all-tasks").onclick=function(e){o.tasks=[],x(i,o).then(e=>console.log(e))};let E,b=new Date(0).toUTCString();function v(e,t){document.cookie=`login=${e.login}`,document.cookie=`binID=${t}`,document.cookie="signed-out=; expires="+b}function B(e){let t;return document.cookie.split("; ").map(e=>e.split("=")).map(n=>n[0]===e?t=n[1]:null),t}function I(){return fetch(g,{headers:{"secret-key":m}}).then(e=>e.json())}function w(e){return fetch(e,{headers:{"secret-key":m}}).then(e=>e.json())}function x(e,t){return fetch(e,{method:"PUT",headers:{"Content-Type":"application/json","secret-key":m,versioning:!1},body:JSON.stringify(t)})}function T(e,t){return e.nextElementSibling.innerText=t}function S(e){e.files[0]&&(e.files[0].size/1024>300?T(e,"Big size of image. Please upload max 300kB"):"image"!=e.files[0].type.split("/")[0]?T(e,"Not an image. Please upload only images"):function(e){T(e,""),document.getElementById("user-photo").src=URL.createObjectURL(e.files[0])}(e))}function L(e){""===e.value?T(e,"This field is required."):e.value.length<8?T(e,"Password should contain as minimum 8 characters"):e.value.match(/[a-z]+/)?e.value.match(/[A-Z]+/)?e.value.match(/\d+/)?T(e,""):T(e,"Password should contain as minimum 1 digit"):T(e,"Password should contain as minimum 1 latin letter in upper register"):T(e,"Password should contain as minimum 1 latin letter in low register")}function j(e){history.replaceState(null,null," "),p(d,r),e.avatar&&(document.getElementById("user-avatar").src=e.avatar),document.getElementById("user-name").innerHTML=`Hello ${e.login}`,document.getElementById("date").innerText=(new Date).toLocaleString("en-US",{dateStyle:"medium"}),function(e,t){new MutationObserver((function(t){t.forEach((function(t){for(let t of document.getElementsByClassName("task-close"))t.onclick=function(t){let n=e.tasks.findIndex(e=>e.id===t.target.parentElement.getAttribute("id"));e.tasks.splice(n,1),t.target.parentNode.remove(),f()};for(let t of document.getElementsByClassName("checkmark"))t.onclick=function(t){let n=t.target.parentElement.parentElement;e.tasks.find(e=>e.id===n.getAttribute("id")).status=h(t.target)}}))})).observe(t,{childList:!0})}(e,document.getElementById("tasks"));for(let t of e.tasks)y(t.task,t.status,t.id);k("new"),f(),document.cookie="signed-out=; expires="+b,l.style.display="none"}document.getElementById("avatar").onchange=function(e){S(e.target);let t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(e){E=e.target.result}},document.getElementById("password").oninput=function(e){L(e.target)},document.getElementById("registration-btn").onclick=function(e){const t={};let n=document.getElementById("avatar"),o=document.getElementById("login"),i=document.getElementById("password"),l=[];if(0!=function(e){const t=e.getElementsByTagName("input");for(let e of t)if("login"==e.id?""===e.value&&T(e,"This field is required."):"avatar"==e.id?S(e):"password"==e.id&&L(e),0!=e.nextElementSibling.textContent.length)var n=!1;return n}(document.getElementById("registration-form"))){n.files[0]?t[n.name]=E:t[n.name]=!1,t[o.name]=o.value;let e,c=Sha256.hash(i.value);t[i.name]=c,t.tasks=l,I().then(t=>t.find(e=>e.login===o)?T(o,"Sorry, but this login is already occupied by another user. "):e=t).then(n=>{if(e){let n;(i=t,fetch(u,{method:"POST",headers:{"Content-Type":"application/json","secret-key":m,"collection-id":"5f1acd08c58dc34bf5d9cd33",name:i.login},body:JSON.stringify(i)}).then(e=>e.json())).then(e=>{s(t),n=e.id,a(n),v(t,n)}).then(i=>{const s={login:o.value,binID:n};e.push(s),x(g,e).then(e=>{j(t)})})}var i})}};let C=document.getElementById("sign-in-form").getElementsByTagName("input");function D(e,t){let n;I().then(t=>{n=t.find(t=>t.login===e.value)}).then(o=>{if(n){let o=n.binID;T(e,""),a(o),w(i).then(e=>{s(e),(!B("binID")||B("binID")!=o)&&v(e,o),P(e,e.password,t.value)})}else T(e,"We can not find user with such login in our database")})}function P(e,t,n){t===Sha256.hash(n)?j(e):T(document.getElementById("user-password"),"Password is wrong. Try again")}document.getElementById("sign-in-btn").onclick=function(e){let t=document.getElementById("user-login"),n=document.getElementById("user-password");for(let e of C)""==e.value&&T(e,"This field is required");B("binID")?(a(B("binID")),w(i).then(e=>{e.login===t.value?P(e,e.password,n.value):D(t,n)})):D(t,n)};for(let e of document.getElementsByClassName("eye"))e.onclick=function(e){let t=e.target.nextElementSibling;"password"===t.type?t.type="text":t.type="password"};document.getElementById("sign-out").onclick=function(e){p(r,d),document.cookie="signed-out=true"},document.getElementById("delete-account").onclick=function(e){let t;I().then(e=>{t=e.filter(e=>e.login!==B("login"))}).then(e=>{var n;(n=i,fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json","secret-key":m}})).then(e=>{x(g,t).then(e=>{document.cookie="login=; expires="+b,document.cookie="binID=; expires="+b,document.cookie="signed out=; expires="+b,p(r,d);for(let e of C)e.value="";p(r,d)})})})};for(let e of C)e.onchange=function(e){""!=e.target.nextElementSibling.innerText&&T(e.target,"")};function O(){window.innerHeight>500&&document.documentElement.style.setProperty("--vh",`${window.innerHeight/100}px`)}B("binID")?B("signed-out")?(document.getElementById("user-login").value=B("login"),l.style.display="none"):(a(B("binID")),w(i).then(e=>{s(e),j(o)})):l.style.display="none",function(){let e=document.getElementsByClassName("quote");e[Math.floor(Math.random()*e.length)].style.display="flex"}(),window.addEventListener("resize",O),window.addEventListener("orientationchange",O),O()}]);